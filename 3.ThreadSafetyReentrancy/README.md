**“纸上得来终觉浅，绝知此事要躬行。”  —— 陆游**

**"Practice，practice，practice and summary make perfect" —— dyliuti**

------



<br>

**简介：**

Qt中从子线程中用信号与槽连接反馈数据，以及需要注意的地方。

<br>

**总结：**

**一：线程反馈数据：**

1.跨线程信号与槽连接要在发送数据前就连上，不然会丢失数据。

2.基于事件的类应该只在一个线程中调用。如QTimer。

<br>

**文件说明：**

1.QueuedConnections1：子线程反馈数据，线程创建用moveToThread。子线程发送定制数据类型的数据到主线程。每点击一次按钮发送一次。

2.QueuedConnections2：子线程反馈数据，线程创建用子类化QThread。除了点击按钮从子线程发送定制数据类型到主线程外，生产者那还开了一个定时器，通过信号槽连接的方式定时向消费者那发送数据。消费者定义在QThread的接口run()函数中。若子线程不开启事件循环，消费者将接收不到数据。

**注意：**定时器开启时间在线程创建之后。若定时器开启在线程创建前，发往线程的数据将丢失。

3.QueuedConnections3：子线程反馈数据，线程创建直接用QThread和moveToThread。提前连接生产者与消费者的信号与槽，使用QThread::started信号关联一个生产者的槽函数（启动生产）。将消费者移动到该线程中。然后开启线程，即开启生产，再发送数据到子线程的消费者中。

4.SlotsInQThreadSubclass：子线程反馈数据，线程创建用子类化QThread。定时器在子类化线程类run()方法中初始化。需要注意的子类化线程中的构造、析构、成员函数是在主线程中的，若在run()外成员函数调用定时器停止或thread()->quit()将导致程序崩溃。因为基于事件的类应该只在一个线程中用。

